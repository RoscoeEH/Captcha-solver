# CAPTCHA Recognition Using LSTM and CNN

This project implements a CAPTCHA recognition system using a Convolutional Neural Network (CNN) and Long Short-Term Memory (LSTM) network. The model is trained to recognize CAPTCHA images, which are 5-8 length strings of alphanumeric characters generated by the python captcha package. The system generates training data, processes CAPTCHA images, and uses Connectionist Temporal Classification (CTC) loss to handle sequence prediction.

## Dependencies

- Python 3.9.6
- PyTorch
- Pandas
- Pillow
- torchvision
- captcha

## Training

1. **Generate CAPTCHA Data**:
   The `captcha_generator.py` script generates CAPTCHA images and labels. Run the script with the number of images you want to generate:
   
   ```bash
   python captcha_generator.py <num_images>
   ```
   
   This will create a folder called `Training_Data` with images and a CSV file `Training_Data_Mappings.csv` containing the corresponding labels.

2. **Train the Model**:
   Use `train_model.py` to train the CAPTCHA recognition model. It will load the images from `Training_Data` and labels from `Training_Data_Mappings.csv`. The model is a CNN followed by an LSTM layer, which is trained using CTC loss.

   Run the training script:
   ```bash
   python train_model.py <num_epochs> <batch_size> <learning_rate>
   ```
   - `<num_epochs>`: Number of epochs for training.
   - `<batch_size>`: The batch size for training.
   - `<learning_rate>`: The learning rate for optimization.

3. **Model Saving**:
   After training, the model will be saved automatically in the current directory as `captcha_recognition_model.pth`.

## Model Architecture

- **CNN Layers**: Two convolutional layers followed by max-pooling.
- **LSTM Layer**: To capture sequential relationships in the CAPTCHA string.
- **Fully Connected Layer**: To output the final predictions.

The model is trained to output a sequence of character predictions for each image. CTC loss is used to train the network because it allows the model to predict sequences of varying lengths without needing to align each output to a specific character.

