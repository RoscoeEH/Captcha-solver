# CAPTCHA Recognition Using LSTM and CNN

This project implements a CAPTCHA recognition system using a Convolutional Neural Network (CNN) and Long Short-Term Memory (LSTM) network. The model is trained to recognize CAPTCHA images, which are 5-8 length strings of alphanumeric characters generated by the python captcha package. The system generates training data, processes CAPTCHA images, and uses Connectionist Temporal Classification (CTC) loss to handle sequence prediction.

## Dependencies

- Python 3.9.6
- PyTorch 2.2.2
- Pandas
- Pillow
- torchvision 0.17.2
- captcha

## Training

1. **Generate CAPTCHA Data**:
   The `generate.py` script generates CAPTCHA images and labels. Run the script with the number of images you want to generate:
   
   ```bash
   python generate.py <num_images>
   ```
   
   This will create a folder called `Training_Data` with images and a CSV file `Training_Data_Mappings.csv` containing the corresponding labels. 
   
   The generate script can be run with the following flags:
   - "-E" - extends the dataset
   - "-T" - data with the names "Test_Data" and :"Test_Data_Mappings.csv"

2. **Train the Model**:
   Use `train_model.py` to train the CAPTCHA recognition model. It will load the images from `Training_Data` and labels from `Training_Data_Mappings.csv`. The model is a CNN followed by an LSTM layer, which is trained using CTC loss.

   Run the training script:
   ```bash
   python training.py 
   ```
   
   The training parameters are in the file "model_parameters.py"

3. **Model Saving**:
   After training, the model will be saved automatically in the current directory as `captcha_recognition_model.pth`.

## Model Architecture

- **CNN Layers**: Two convolutional layers followed by max-pooling.
- **LSTM Layer**: To capture sequential relationships in the CAPTCHA string.
- **Fully Connected Layer**: To output the final predictions.

The model is trained to output a sequence of character predictions for each image. CTC loss is used to train the network because it allows the model to predict sequences of varying lengths without needing to align each output to a specific character.

## Evaluation

The model's performance can be evaluated using the following metrics:

1. **Character-Level Accuracy**: The percentage of individual characters correctly predicted across all CAPTCHAs.
2. **Full-String Accuracy**: The percentage of CAPTCHA strings that are perfectly predicted (all characters correct).

To evaluate the model on your test data, use the evaluation script:
```bash
python evaluate.py
```
This can be run with the flag "-V" to view each captcha an attempt from the model.

The script will load the trained model from `captcha_recognition_model.pth` and output:
- Overall accuracy metrics
- Sample predictions with their corresponding ground truth labels


The model's performance can vary significantly based on:
- Quality and quantity of training data
- Complexity of the CAPTCHA patterns
- Model hyperparameters
- Training duration

